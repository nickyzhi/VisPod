

<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body id = "canvas">

	<script type="text/javascript" src="d3.min.js"></script>

	<script>
	//TODO Replace concordance[0] with some sortt of loop
	myjson = {"fname": "ssh_channel_read ","vars": [{"vname": " count ", "concordance": [{"possibleVal": "256", "frequency":1}]},{"vname": " is_stderr ", "concordance": [{"possibleVal": "0", "frequency":1}]},{"vname": " $return_value ", "concordance": [{"possibleVal": "2", "frequency":1}]},{"vname": " count ", "concordance": [{"possibleVal": "256", "frequency":1}]},{"vname": " is_stderr ", "concordance": [{"possibleVal": "0", "frequency":1}]},{"vname": " $return_value ", "concordance": [{"possibleVal": "2", "frequency":1}]}]};

	myjson2 = {"d":{" count ":{"256": {"dependancies": {" $return_value ": {"2": 1}, " is_stderr ": {"0": 1}}}}," is_stderr ":{"0": {"dependancies": {" $return_value ": {"2": 1}, " count ": {"256": 1}}}}," $return_value ":{"2": {"dependancies": {" count ": {"256": 1}, " is_stderr ": {"0": 1}}}}," count ":{"256": {"dependancies": {" $return_value ": {"2": 1}, " is_stderr ": {"0": 1}}}}," is_stderr ":{"0": {"dependancies": {" $return_value ": {"2": 1}, " count ": {"256": 1}}}}," $return_value ":{"2": {"dependancies": {" count ": {"256": 1}, " is_stderr ": {"0": 1}}}}}};

	totalFrequencies = [] //Stores all of the total frequencies used for determining percentiles
	numItems = 0; //Counter for adding and spacing all of our bars
	index = 0;

	canvas = d3.select("#canvas");
	vis = canvas.append("svg:svg").attr("width",500).attr("height", 200);
	console.log("We have vis");


	//Sums al of our fequencies
	for (i=0;i<myjson.vars.length;i++){
		totalFrequencies[i] = 0;
		for (j=0;j<myjson.vars[i].concordance.length;j++){
			totalFrequencies[i] += myjson.vars[i].concordance[j].frequency; 
		}
	}

	//Draw our horizontal bars
	
	vis.selectAll("rect")
		.data(myjson.vars)
		.enter()
		.append("svg:rect")
		.attr("y", function(){numItems++; return (numItems * 20);})
		.attr("height", 15)
		.attr("width", function(datum) {return datum.concordance[index].frequency / totalFrequencies[index] * 100;})
		;
	
		
	for (i=0;i<myjson.vars.length;i++) {
		for (j=0;j<myjson.vars[i].concordance.length;j++) {
			vis.append("svg:rect")
				.attr("y", (i+1)*20)
				.attr("x", (j+1)*110)
				.attr("height", 15)
				.attr("width", myjson.vars[i].concordance[j].frequency / totalFrequencies[0] * 100)
				;
		}
	}

	keys = (Object.keys(myjson2.d));
	for (i=0;i<keys.length;i++){
		vals = Object.keys(myjson2.d[keys[i]]);
		for (j=0;j<vals.length;j++) {
			dvals = Object.keys(myjson2.d[keys[i]][vals[j]].dependancies);
			for(k=0;k<dvals.length;k++){
				dvalFreq = Object.keys(myjson2.d[keys[i]][vals[j]].dependancies[dvals[k]]);

				for(l=0;l<dvalFreq.length;l++){
					
					value = (myjson2.d[keys[i]][vals[j]].dependancies[dvals[k]][dvalFreq[l]]);

					vis.append("svg:rect")
					.attr("y", (i+1)*20)
					.attr("x", (j+1)*110 + 200)
					.attr("height", 15)
					.attr("width", value / totalFrequencies[0] * 100)
				;
				}
			}
		}
	}
	

	</script>
</body>
</html>